{% extends 'base.html' %}

{% block content %}
<h2>Editar Borrador</h2>

<form method="post" enctype="multipart/form-data">
  {% csrf_token %}
  
  <div class="mb-3">
    <label for="asunto" class="form-label">Asunto:</label>
    <input type="text" class="form-control" id="asunto" name="asunto" value="{{ borrador.asunto }}">
  </div>

  <div class="mb-3">
    <label for="cuerpo_html" class="form-label">Cuerpo del email:</label>
    <textarea id="editor" name="cuerpo_html">{{ borrador.cuerpo }}</textarea>
  </div>

  <div class="mb-3">
    <label for="archivo_adjunto" class="form-label">Archivo adjunto:</label>
    <input type="file" class="form-control" id="archivo_adjunto" name="archivo_adjunto">
    {% if borrador.archivo_adjunto %}
      <p>Archivo actual: <a href="{{ borrador.archivo_adjunto.url }}" target="_blank">{{ borrador.archivo_adjunto.name }}</a></p>
    {% endif %}
  </div>
  <input type="hidden" name="cliente" id="cliente_id" value="{{ borrador.cliente.id }}">
  <input type="hidden" name="fecha_1" id="fecha_1">
  <input type="hidden" name="fecha_2" id="fecha_2">
  <input type="hidden" name="plantilla" id="plantilla_id" value="{{ borrador.plantilla.id }}">

  <a id="dashboard" href="" target="_blank" rel="noopener noreferrer">Editar Informe</a>
  <button id="regen" type="button">Generar informe</button>


  <button type="submit" class="btn btn-primary">Guardar Cambios</button>
  <a href="{% url 'lista_borradores' %}" class="btn btn-secondary">Cancelar</a>
</form>

<script src="https://cdn.ckeditor.com/ckeditor5/41.0.0/classic/ckeditor.js"></script>
<script>
  
  ClassicEditor
    .create(document.querySelector('#editor'))
    .catch(error => {
      console.error(error);
    });
</script>
{% endblock %}